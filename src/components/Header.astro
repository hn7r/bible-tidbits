---
import {FACEBOOK_URL, INSTAGRAM_URL, PODCAST_URL, SITE_TITLE, YOUTUBE_URL} from '../consts';
import HeaderLink from './HeaderLink.astro';
import logo from '../assets/logo.svg';
import microphoneIcon from '../assets/microphone.svg';
import facebookIcon from '../assets/facebook-fill.svg';
import youtubeIcon from '../assets/youtube.svg';
import instagramIcon from '../assets/instagram-logo-thin.svg';
---

<header>
    <nav>
        <h2>
            <a href="/">
                <div class="logo-container">
                    <img src={logo.src} alt="Bible Tidbits logo" width="48" height="48" />
                    <div class="site-title">
                        {SITE_TITLE}
                    </div>
                </div>
            </a>
        </h2>

        <!-- Mobile menu button -->
        <button class="mobile-menu-btn" type="button">
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
        </button>

        <!-- Navigation menu -->
        <div class="nav-menu">
            <div class="internal-links">
                <HeaderLink href="/bible-tidbits">Home</HeaderLink>
                <HeaderLink href="/bible-tidbits/blog">Blog</HeaderLink>
                <HeaderLink href="/bible-tidbits/about">About</HeaderLink>
            </div>
            <div class="social-links">
                <a href={YOUTUBE_URL} target="_blank">
                    <span class="sr-only">Go to the Bible Tidbits YouTube channel</span>
                    <img src={youtubeIcon.src} alt="YouTube" width="28" height="28" />
                </a>
                <a href={PODCAST_URL} target="_blank">
                    <span class="sr-only">Listen to the Podcast</span>
                    <img src={microphoneIcon.src} alt="Podcast" width="28" height="28" />
                </a>
                <a href={INSTAGRAM_URL} target="_blank">
                    <span class="sr-only">Go to the Bible Tidbits Instagram page</span>
                    <img src={instagramIcon.src} alt="Instagram" width="28" height="28" />
                </a>
                <a href={FACEBOOK_URL} target="_blank">
                    <span class="sr-only">Go to the Bible Tidbits Facebook page</span>
                    <img src={facebookIcon.src} alt="Facebook" width="28" height="28" />
                </a>
            </div>
        </div>
    </nav>
</header>

<style>
    header {
        margin: 0;
        padding: 0 1em;
        background: white;
        box-shadow: 0 2px 8px rgba(var(--black), 5%);
        position: sticky;
        top: 0;
        z-index: 100;
    }

    h2 {
        margin: 0;
        font-size: 1em;
    }

    h2 a,
    h2 a.active {
        text-decoration: none;
    }

    .logo-container {
        display: flex;
        align-items: center;
    }

    .site-title {
        margin-left: 0.75em;
        font-size: 1.5em;
        font-weight: bold;
        line-height: 1;
    }

    nav {
        display: flex;
        align-items: center;
        justify-content: space-between;
        min-height: 60px;
    }

    .mobile-menu-btn {
        display: none;
        flex-direction: column;
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        gap: 4px;
    }

    .hamburger-line {
        width: 25px;
        height: 3px;
        background-color: rgb(var(--black));
        transition: all 0.3s ease;
    }

    .nav-menu {
        display: flex;
        align-items: center;
        gap: 2em;
    }

    .internal-links {
        display: flex;
        gap: 0.5em;
    }

    nav a {
        padding: 1em 0.5em;
        color: var(--black);
        border-bottom: 4px solid transparent;
        text-decoration: none;
    }

    nav a.active {
        text-decoration: none;
        border-bottom-color: var(--accent);
    }

    .social-links,
    .social-links a {
        display: flex;
        gap: 0.75em;
    }

    /* Mobile styles */
    @media (max-width: 720px) {
        header {
            padding: 0 0.5em;
        }

        nav {
            min-height: 50px;
        }

        .logo-container img {
            width: 40px;
            height: 40px;
        }

        .site-title {
            font-size: 1.2em;
            margin-left: 0.5em;
        }

        .mobile-menu-btn {
            display: flex;
        }

        .nav-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 4px 6px rgba(var(--black), 10%);
            flex-direction: column;
            padding: 1em;
            gap: 1em;
        }

        .nav-menu.open {
            display: flex;
        }

        .internal-links {
            flex-direction: column;
            width: 100%;
            gap: 0;
        }

        .internal-links a {
            padding: 0.75em 0;
            border-bottom: 1px solid rgba(var(--gray-light), 50%);
            width: 100%;
        }

        .social-links {
            justify-content: center;
            padding-top: 1em;
            border-top: 1px solid rgba(var(--gray-light), 50%);
        }

        .social-links img {
            width: 24px;
            height: 24px;
        }

        /* Hamburger animation */
        .mobile-menu-btn.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .mobile-menu-btn.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-btn.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }
    }

    @media (max-width: 480px) {
        .site-title {
            font-size: 1em;
        }

        .logo-container img {
            width: 36px;
            height: 36px;
        }
    }
</style>

<script>
    function initMobileMenu() {
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn') as HTMLButtonElement;
        const navMenu = document.querySelector('.nav-menu') as HTMLElement;

        if (mobileMenuBtn && navMenu) {
            mobileMenuBtn.addEventListener('click', function() {
                navMenu.classList.toggle('open');
                mobileMenuBtn.classList.toggle('active');
            });

            // Close menu when clicking outside
            document.addEventListener('click', function(e) {
                const target = e.target as HTMLElement;
                if (!mobileMenuBtn.contains(target) && !navMenu.contains(target)) {
                    navMenu.classList.remove('open');
                    mobileMenuBtn.classList.remove('active');
                }
            });

            // Close menu when window is resized to desktop
            window.addEventListener('resize', function() {
                if (window.innerWidth > 720) {
                    navMenu.classList.remove('open');
                    mobileMenuBtn.classList.remove('active');
                }
            });
        }
    }

    // Initialize when DOM is loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initMobileMenu);
    } else {
        initMobileMenu();
    }
</script>